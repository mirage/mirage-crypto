<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mirage_crypto_rng_miou_unix (mirage-crypto-rng-miou-unix.Mirage_crypto_rng_miou_unix)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Index</a> &#x00BB; <a href="../index.html">mirage-crypto-rng-miou-unix</a> &#x00BB; Mirage_crypto_rng_miou_unix</nav><header class="odoc-preamble"><h1>Module <code><span>Mirage_crypto_rng_miou_unix</span></code></h1><p><b>RNG</b> seeding on <b>Miou_unix</b>.</p><p>This module initializes a RNG with <code>getrandom()</code>, and CPU RNG. On BSD system (FreeBSD, OpenBSD, MacOS) <code>getentropy()</code> is used instead of <code>getrandom()</code>. On Windows 10 or higher, <code>BCryptGenRandom()</code> is used with the default RNG. Windows 8 or lower are not supported by this library.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Pfortuna"><a href="#module-Pfortuna" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Pfortuna/index.html">Pfortuna</a></span><span> : <a href="../../mirage-crypto-rng/Mirage_crypto_rng/module-type-Generator/index.html">Mirage_crypto_rng.Generator</a></span></code></div><div class="spec-doc"><p><b>Pfortuna</b>, a <b>domain-safe</b> CSPRNG <a href="https://www.schneier.com/fortuna.html">proposed</a> by Schneier.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-rng"><a href="#type-rng" class="anchor"></a><code><span><span class="keyword">type</span> rng</span></code></div><div class="spec-doc"><p>Type of tasks seeding the RNG.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-initialize"><a href="#val-initialize" class="anchor"></a><code><span><span class="keyword">val</span> initialize : <span><span class="optlabel">?g</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?sleep</span>:int64 <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../mirage-crypto-rng/Mirage_crypto_rng/index.html#type-generator">Mirage_crypto_rng.generator</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-rng">rng</a></span></code></div><div class="spec-doc"><p><code>initialize ?g ?sleep (module Generator)</code> will allow the RNG to operate in a returned task. This task periodically launches sub-tasks that seed the engine (using <code>getrandom()</code>, <code>getentropy()</code> or <code>BCryptGenRandom()</code> depending on the system). These sub-tasks must be cleaned periodically (in seconds) according to the <code>sleep</code> parameter given (defaults to 1 second).</p><p>The user must then <a href="#val-kill"><code>kill</code></a> the returned task at the end of the program to be sure to clean everything. Otherwise, Miou will complain with the exception <code>Still_has_children</code>.</p><p>We strongly recommend using <a href="Pfortuna/index.html"><code>Pfortuna</code></a> as an RNG engine rather than <a href="../../mirage-crypto-rng/Mirage_crypto_rng/Fortuna/index.html"><code>Mirage_crypto_rng.Fortuna</code></a>. The engine is launched in parallel with the other tasks if at least one domain is available. To ensure that there is no compromise in the values generated by a <i>data-race</i>, <code>Pfortuna</code> is an <b>domain-safe</b> implementation of Fortuna.</p><p>The user cannot make any subsequent calls to <code>initialize</code>. In other words, you can only initialise a single <a href="#type-rng"><code>rng</code></a> task. You must <a href="#val-kill"><code>kill</code></a> the returned <a href="#type-rng"><code>rng</code></a> if you want to re-initialise the RNG.</p><p>A basic usage of <code>mirage-crypto-rng-miou-unix</code> is:</p><pre class="language-ocaml"><code>  let () = Miou_unix.run @@ fun () -&gt;
    let rng = Mirage_crypto_rng_miou_unix.(initialize (module Pfortuna)) in
    let str = Mirage_crypto_rng.generate 16 in
    Format.printf &quot;random: %S\n%!&quot; str;
    Mirage_crypto_rng_miou_unix.kill rng</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kill"><a href="#val-kill" class="anchor"></a><code><span><span class="keyword">val</span> kill : <span><a href="#type-rng">rng</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>kill rng</code> terminates the <i>background</i> task which seeds the RNG.</p></div></div></div></body></html>

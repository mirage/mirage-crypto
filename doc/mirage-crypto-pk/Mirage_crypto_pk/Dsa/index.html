<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dsa (mirage-crypto-pk.Mirage_crypto_pk.Dsa)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">mirage-crypto-pk</a> &#x00BB; <a href="../index.html">Mirage_crypto_pk</a> &#x00BB; Dsa</nav><header class="odoc-preamble"><h1>Module <code><span>Mirage_crypto_pk.Dsa</span></code></h1><p><b>DSA</b> digital signature algorithm.</p></header><nav class="odoc-toc"><ul><li><a href="#dsa-signature-algorithm">DSA signature algorithm</a></li></ul></nav><div class="odoc-content"><h2 id="dsa-signature-algorithm"><a href="#dsa-signature-algorithm" class="anchor"></a>DSA signature algorithm</h2><div class="odoc-spec"><div class="spec type anchored" id="type-priv"><a href="#type-priv" class="anchor"></a><code><span><span class="keyword">type</span> priv</span><span> = <span class="keyword">private</span> </span><span>{</span></code><ol><li id="type-priv.p" class="def record field anchored"><a href="#type-priv.p" class="anchor"></a><code><span>p : <span class="xref-unresolved">Z</span>.t;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Modulus</p><span class="comment-delim">*)</span></div></li><li id="type-priv.q" class="def record field anchored"><a href="#type-priv.q" class="anchor"></a><code><span>q : <span class="xref-unresolved">Z</span>.t;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Subgroup order</p><span class="comment-delim">*)</span></div></li><li id="type-priv.gg" class="def record field anchored"><a href="#type-priv.gg" class="anchor"></a><code><span>gg : <span class="xref-unresolved">Z</span>.t;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Group Generator</p><span class="comment-delim">*)</span></div></li><li id="type-priv.x" class="def record field anchored"><a href="#type-priv.x" class="anchor"></a><code><span>x : <span class="xref-unresolved">Z</span>.t;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Private key proper</p><span class="comment-delim">*)</span></div></li><li id="type-priv.y" class="def record field anchored"><a href="#type-priv.y" class="anchor"></a><code><span>y : <span class="xref-unresolved">Z</span>.t;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Public component</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Private key. <code>p</code>, <code>q</code> and <code>gg</code> comprise <i>domain parameters</i>.</p><p><em><code>Sexplib</code> convertible</em>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-priv"><a href="#val-priv" class="anchor"></a><code><span><span class="keyword">val</span> priv : 
  <span><span class="optlabel">?fips</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">p</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">q</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">gg</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">x</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">y</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-priv">priv</a>, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>priv ~fips ~p ~q ~gg ~x ~y ()</code> constructs a private DSA key from the given numbers. Will result in an error if parameters are ill-formed: same as <a href="#val-pub"><code>pub</code></a>, and additionally <code>0 &lt; x &lt; q</code> and <code>y = g ^ x mod p</code>. Note that no time masking is done on the modular exponentiation.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-pub"><a href="#type-pub" class="anchor"></a><code><span><span class="keyword">type</span> pub</span><span> = <span class="keyword">private</span> </span><span>{</span></code><ol><li id="type-pub.p" class="def record field anchored"><a href="#type-pub.p" class="anchor"></a><code><span>p : <span class="xref-unresolved">Z</span>.t;</span></code></li><li id="type-pub.q" class="def record field anchored"><a href="#type-pub.q" class="anchor"></a><code><span>q : <span class="xref-unresolved">Z</span>.t;</span></code></li><li id="type-pub.gg" class="def record field anchored"><a href="#type-pub.gg" class="anchor"></a><code><span>gg : <span class="xref-unresolved">Z</span>.t;</span></code></li><li id="type-pub.y" class="def record field anchored"><a href="#type-pub.y" class="anchor"></a><code><span>y : <span class="xref-unresolved">Z</span>.t;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Public key, a subset of <a href="#type-priv" title="priv">private key</a>.</p><p><em><code>Sexplib</code> convertible</em>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pub"><a href="#val-pub" class="anchor"></a><code><span><span class="keyword">val</span> pub : 
  <span><span class="optlabel">?fips</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">p</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">q</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">gg</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">y</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-pub">pub</a>, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>pub ~fips ~p ~q ~gg ~y ()</code> constructs a public DSA key from the given numbers. Will result in an error if the parameters are not well-formed: <code>one &lt; gg &lt; p</code>, <code>q</code> probabilistically a prime, <code>p</code> probabilistically prime and odd, <code>0 &lt; y &lt; p</code>, <code>q &lt; p</code>, and <code>p - 1 mod q = 0</code>. If <code>fips</code> is specified and <code>true</code> (defaults to <code>false</code>), only FIPS-specified bit length for <code>p</code> and <code>q</code> are accepted.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-keysize"><a href="#type-keysize" class="anchor"></a><code><span><span class="keyword">type</span> keysize</span><span> = </span><span>[ </span></code><ol><li id="type-keysize.Fips1024" class="def variant constructor anchored"><a href="#type-keysize.Fips1024" class="anchor"></a><code><span>| </span><span>`Fips1024</span></code></li><li id="type-keysize.Fips2048" class="def variant constructor anchored"><a href="#type-keysize.Fips2048" class="anchor"></a><code><span>| </span><span>`Fips2048</span></code></li><li id="type-keysize.Fips3072" class="def variant constructor anchored"><a href="#type-keysize.Fips3072" class="anchor"></a><code><span>| </span><span>`Fips3072</span></code></li><li id="type-keysize.Exactly" class="def variant constructor anchored"><a href="#type-keysize.Exactly" class="anchor"></a><code><span>| </span><span>`Exactly <span class="keyword">of</span> <a href="../index.html#type-bits">bits</a> * <a href="../index.html#type-bits">bits</a></span></code></li></ol><code><span> ]</span></code></div><div class="spec-doc"><p>Key size request. Three <em>Fips</em> variants refer to FIPS-standardized L-values (<code>p</code> size) and imply the corresponding N (<code>q</code> size); The last variants specifies L and N directly.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mask"><a href="#type-mask" class="anchor"></a><code><span><span class="keyword">type</span> mask</span><span> = </span><span>[ </span></code><ol><li id="type-mask.No" class="def variant constructor anchored"><a href="#type-mask.No" class="anchor"></a><code><span>| </span><span>`No</span></code></li><li id="type-mask.Yes" class="def variant constructor anchored"><a href="#type-mask.Yes" class="anchor"></a><code><span>| </span><span>`Yes</span></code></li><li id="type-mask.Yes_with" class="def variant constructor anchored"><a href="#type-mask.Yes_with" class="anchor"></a><code><span>| </span><span>`Yes_with <span class="keyword">of</span> <a href="../../../mirage-crypto-rng/Mirage_crypto_rng/index.html#type-g">Mirage_crypto_rng.g</a></span></code></li></ol><code><span> ]</span></code></div><div class="spec-doc"><p>Masking (cryptographic blinding) option.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pub_of_priv"><a href="#val-pub_of_priv" class="anchor"></a><code><span><span class="keyword">val</span> pub_of_priv : <span><a href="#type-priv">priv</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-pub">pub</a></span></code></div><div class="spec-doc"><p>Extract the public component from a private key.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generate"><a href="#val-generate" class="anchor"></a><code><span><span class="keyword">val</span> generate : <span><span class="optlabel">?g</span>:<a href="../../../mirage-crypto-rng/Mirage_crypto_rng/index.html#type-g">Mirage_crypto_rng.g</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-keysize">keysize</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-priv">priv</a></span></code></div><div class="spec-doc"><p><code>generate g size</code> is a fresh <a href="#type-priv" title="priv">private</a> key. The domain parameters are derived using a modified FIPS.186-4 probabilistic process, but the derivation can not be validated. Note that no time masking is done for the modular exponentiations.</p><p><b>Note</b> The process might diverge if it is impossible to find parameters with the given bit sizes. This happens when <code>n</code> gets too big for <code>l</code>, if the <code>size</code> was given as <code>`Exactly (l, n)</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if <code>size</code> is (`Exactly (l, n)), and either <code>l</code> or <code>n</code> is ridiculously small.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sign"><a href="#val-sign" class="anchor"></a><code><span><span class="keyword">val</span> sign : 
  <span><span class="optlabel">?mask</span>:<a href="#type-mask">mask</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?k</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">key</span>:<a href="#type-priv">priv</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>sign ~mask ~k ~key digest</code> is the signature, a pair of <code>Cstruct.t</code>s representing <code>r</code> and <code>s</code> in big-endian.</p><p><code>digest</code> is the full digest of the actual message.</p><p><code>k</code>, the random component, can either be provided, or is deterministically derived as per RFC6979, using SHA256.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if <code>k</code> is unsuitable (leading to r or s being 0).</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span><span class="keyword">val</span> verify : <span><span class="label">key</span>:<a href="#type-pub">pub</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>verify ~key (r, s) digest</code> verifies that the pair <code>(r, s)</code> is the signature of <code>digest</code>, the message digest, under the private counterpart to <code>key</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-massage"><a href="#val-massage" class="anchor"></a><code><span><span class="keyword">val</span> massage : <span><span class="label">key</span>:<a href="#type-pub">pub</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>massage key digest</code> is the numeric value of <code>digest</code> taken modulo <code>q</code> and represented in the leftmost <code>bits(q)</code> bits of the result.</p><p>Both FIPS.186-4 and RFC6979 specify that only the leftmost <code>bits(q)</code> bits of <code>digest</code> are to be taken into account, but some implementations consider the entire <code>digest</code>. In cases where <a href="#val-sign" title="sign">sign</a> and <a href="#val-verify" title="verify">verify</a> seem incompatible with a given implementation (esp. if <a href="#val-sign" title="sign">sign</a> produces signatures with the <code>s</code> component different from the other implementation's), it might help to pre-process <code>digest</code> using this function (e.g. <code>sign ~key (massage ~key:(pub_of_priv key) digest)</code>).</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-K_gen"><a href="#module-K_gen" class="anchor"></a><code><span><span class="keyword">module</span> <a href="K_gen/index.html">K_gen</a></span><span> (<a href="K_gen/argument-1-H/index.html">H</a> : <a href="../../../mirage-crypto/Mirage_crypto/Hash/module-type-S/index.html">Mirage_crypto.Hash.S</a>) : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>K_gen</code> can be instantiated over a hashing module to obtain an RFC6979 compliant <code>k</code>-generator for that hash.</p></div></div></div></body></html>

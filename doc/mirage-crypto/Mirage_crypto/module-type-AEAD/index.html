<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>AEAD (mirage-crypto.Mirage_crypto.AEAD)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">mirage-crypto</a> &#x00BB; <a href="../index.html">Mirage_crypto</a> &#x00BB; AEAD</nav><header class="odoc-preamble"><h1>Module type <code><span>Mirage_crypto.AEAD</span></code></h1><p>Authenticated encryption with associated data.</p><p>This defines a uniform interface of symmetrics cryptographic algorithms which encrypt, and also protect the integrity of the data. Additional data, only used for integrity protection, not encrypted and not part of the ciphertext, can be passed in optionally. This prevents the same ciphertext being used at a different location. See <a href="https://tools.ietf.org/html/rfc5116">RFC 5116</a> for further description.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-key" class="anchored"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> key</span></code></div><div class="spec-doc"><p>The abstract type for the key.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-authenticate_encrypt" class="anchored"><a href="#val-authenticate_encrypt" class="anchor"></a><code><span><span class="keyword">val</span> authenticate_encrypt : <span>key:<a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span>nonce:<span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span>?adata:<span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>authenticate_encrypt ~key ~nonce ~adata msg</code> encrypts <code>msg</code> with <code>key</code> and <code>nonce</code>, and appends an authentication tag computed over the encrypted <code>msg</code>, using <code>key</code>, <code>nonce</code>, and <code>adata</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">Invalid_argument</span> <p>if <code>nonce</code> is not of the right size.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-authenticate_decrypt" class="anchored"><a href="#val-authenticate_decrypt" class="anchor"></a><code><span><span class="keyword">val</span> authenticate_decrypt : <span>key:<a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span>nonce:<span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span>?adata:<span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t option</span></span></code></div><div class="spec-doc"><p><code>authenticate_decrypt ~key ~nonce ~adata msg</code> splits <code>msg</code> into encrypted data and authentication tag, computes the authentication tag using <code>key</code>, <code>nonce</code>, and <code>adata</code>, and decrypts the encrypted data. If the authentication tags match, the decrypted data is returned.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">Invalid_argument</span> <p>if <code>nonce</code> is not of the right size.</p></li></ul></div></div></div></body></html>